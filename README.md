# microcontroler
Микроконтроллер (МК) — это не просто процессор, а целый компьютер на одной микросхеме. Его компонентную базу можно разделить на несколько ключевых блоков.

## 1. Ядро процессора (CPU) — "Мозг" системы
Это главный вычислительный блок. В STM32 используются ядра серии ARM Cortex-M:

Cortex-M0/M0+: Низкое энергопотребление и стоимость. Идеальны для простых задач, заменяют старые 8-битные МК.

Cortex-M3: Баланс производительности и эффективности. Классика для широкого круга задач.

Cortex-M4: Добавляет блок DSP (Digital Signal Processor) и FPU (Floating Point Unit) — модуль для аппаратного вычисления чисел с плавающей запятой. Это ускоряет математические операции, фильтры, обработку сигналов.

Cortex-M7: Высокопроизводительное ядро с тактовой частотой до 500+ МГц, кешем, опционально FPU двойной точности.

Назначение: Выполнение программного кода, арифметические и логические операции, управление всеми периферийными устройствами.

## 2. Память — "Хранилище данных и программ"
Flash-память: Энергонезависимая память, где хранится прошивка (ваша программа). При отключении питания данные не стираются.

SRAM (ОЗУ): Энергозависимая память для временного хранения данных. Здесь создаются переменные, стеки, буферы во время работы программы. При отключении питания данные теряются.

EEPROM (на некоторых моделях): Энергонезависимая память для хранения пользовательских данных, которые не должны теряться при отключении питания (настройки, калибровочные константы, счетчики). Часто эмулируется во Flash.

## 3. Системная тактовая система (Clock System) — "Сердцебиение"
Генерирует тактовые импульсы, которые синхронизируют работу всех компонентов МК. Включает в себя:

Внутренние RC-генераторы (HSI, LSI): Неточные, но дешевые и быстрые источники тактирования.

Внешние кварцевые резонаторы (HSE, LSE): Обеспечивают высокую точность тактирования. HSE — для основной системы, LSE — для часов реального времени (RTC).

PLL (Phase-Locked Loop): Умножает частоту от внутреннего или внешнего генератора, чтобы получить высокую тактовую частоту для ядра.

Назначение: Задает темп работы МК. Позволяет балансировать между производительностью и энергопотреблением.

## 4. Периферийные устройства — "Органы чувств и действия"
Это самые важные для пользователя блоки, которые позволяют МК взаимодействовать с внешним миром.

Цифровые интерфейсы ввода/вывода (GPIO - General Purpose Input/Output)
Назначение: Универсальные выводы, которые можно программно настроить как вход (читать напряжение: "0" или "1") или как выход (устанавливать напряжение: "0" или "1"). Основа для работы с кнопками, светодиодами, реле и т.д.

Интерфейсы связи
UART/USART (Universal Asynchronous/Synchronous Receiver-Transmitter): Последовательный асинхронный интерфейс. Простой, надежный.

Назначение: Обмен данными с компьютерами (через USB-UART преобразователь), GPS-модулями, Bluetooth-модулями, другими МК.

I2C (Inter-Integrated Circuit): Двухпроводной последовательный синхронный интерфейс (данные SDA и такты SCL).

Назначение: Связь с множеством датчиков (температуры, давления, акселерометрами), EEPROM, LCD-дисплеями. Много устройств на одной шине.

SPI (Serial Peripheral Interface): Высокоскоростной последовательный синхронный интерфейс (данные MISO, MOSI, такты SCK и выбор устройства CS).

Назначение: Связь с SD-картами, LCD-дисплеями, FLASH-памятью, беспроводными модулями (Wi-Fi, nRF24L01).

USB (Universal Serial Bus):

Назначение: Подключение к компьютеру в качестве устройства (например, создание виртуального COM-порта, HID-клавиатуры/мыши) или хоста (для подключения флешек).

CAN (Controller Area Network):

Назначение: Надежная сеть для промышленных и автомобильных применений. Устойчив к помехам.

Ethernet MAC:

Назначение: Подключение к локальной сети Ethernet. Требует внешнего PHY-чипа.

## Аналоговые периферийные устройства
##АЦП
(ADC - Analog-to-Digital Converter):

Назначение: Преобразует аналоговое напряжение (например, с потенциометра, датчика температуры, микрофона) в цифровое значение, которое может обработать процессор.

## ЦАП
(DAC - Digital-to-Analog Converter):

Назначение: Преобразует цифровое значение в аналоговое напряжение. Используется для генерации звука, управляющих сигналов и т.д.

## Компаратор 
(Comparator):

Назначение: Сравнивает два аналоговых напряжения и выдает цифровой сигнал ("1" или "0") в зависимости от того, какое напряжение больше. Работает очень быстро.

##  Таймеры
(Timers) — "Мышечная память и чувство времени"
Очень гибкие и мощные блоки. Бывают простые (TIM) и продвинутые (Advanced-control TIM).

Назначение:

Генерация ШИМ (PWM - Pulse Width Modulation): Управление скоростью моторов, яркостью светодиодов, сервоприводами.

Измерение длительности импульсов: Определение частоты сигнала, скорости вращения энкодера.

Счет событий.

Создание временных задержек и периодических прерываний (вместо функции delay()).

Система прерываний (NVIC - Nested Vectored Interrupt Controller)
Назначение: Обработка внешних событий в реальном времени. Когда наступает событие (например, пришел байт по UART, нажата кнопка, сработал таймер), основная программа приостанавливается, и выполняется специальная функция-обработчик прерывания. Это основа реактивности систем.

Контроллер прямого доступа к памяти (DMA - Direct Memory Access)
Назначение: Позволяет периферийным устройствам обмениваться данными с памятью без участия ядра. Ядро в это время может выполнять другой код. Резко повышает общую производительность системы. Например, данные с АЦП могут напрямую записываться в массив в RAM, а принятые по UART байты — сразу складываться в буфер.

Система отладки (SWD/JTAG)
Назначение: Интерфейс для прошивки МК и пошаговой отладки программы прямо на устройстве. Позволяет видеть значения переменных, устанавливать точки останова.

## Как всё это работает вместе? Простой пример.
Задача: Считать показания с потенциометра (аналоговое значение) и управлять яркостью светодиода с помощью ШИМ.

АЦП по команде от ядра начинает преобразование напряжения с ножки, к которой подключен потенциометр.

DMA по сигналу от АЦП забирает результат преобразования и кладет его в переменную в SRAM, не нагружая ядро.

Ядро считывает значение переменной и на его основе вычисляет необходимый коэффициент заполнения ШИМ.

Ядро записывает это значение в регистр Таймера, настроенного на генерацию ШИМ.

Таймер автоматически, без участия ядра, генерирует на своей выходной ножке (GPIO, настроенный как выход) импульсы с нужной скважностью.

Светодиод, подключенный к этой ножке, меняет яркость.

Вся компонентная база STM32 спроектирована так, чтобы максимально разгрузить ядро для сложных вычислений, переложив рутинные задачи на периферию, что делает эти микроконтроллеры невероятно эффективными и гибкими.
